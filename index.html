<!DOCTYPE html>
<html lang="en">

<head>
    <title>Memory Game</title>
    <meta charset="UTF-8">
    <style>
        #start {
            background-color: rgb(64, 148, 226);
            text-align: center;
            border-radius: 10px;
            padding: 15px;
            margin-top: 30px;
            color: white;
        }

        #start:hover {
            background-color: crimson;
        }

        .gameTile {
            display: inline-block;
            padding: 3px;
        }

        .flipImage {
            max-width: 150px;
        }
    </style>
</head>

<body>
    <div id="start">Start</div>
    <div id="score"></div>
    <div id="message"></div>
    <div id="gameboard"></div>

    <script>
        let playLockout = false;
        let gamePlay = false;
        let tileImages = [],
            tileArray = [],
            tileFlippedOver = [];
        let cardFlipped = -1;
        let timer;
        let startBtn = document.getElementById('start');
        startBtn.addEventListener('click', startGame);
        let message = document.getElementById('message');
        let score = document.getElementById('score');
        let gameBoard = document.getElementById('gameboard');

        function startGame() {
            startBtn.style.display = 'none';
            if (!gamePlay) {
                gamePlay = true;
                buildArray();
                tileArray = tileImages.concat(tileImages);
                shuffleArray(tileArray);
                buildBoard();
            }
        }

        function buildBoard() {
            let html = '';
            let x = 0;
            tileArray.forEach(function (ele) {
                x++;
                html += '<div class="gameTile">';
                html += '<img id="cards' + x + '"src = "http://via.placeholder.com/250/000000/ffffff?text=click" onclick="pickCard(' + (x - 1) + ', this)" class = "flipImage"></div>';
            });
            gameBoard.innerHTML = html;
        }

        function pickCard(i, t) {
            if (!playLockout && !isinArray(t.id, tileFlippedOver)) {
                if (cardFlipped >= 0) {
                    cardFlip(i, t);
                    playLockout = true;
                    if (checkSrc(tileFlippedOver[tileFlippedOver.length - 1]) == checkSrc(tileFlippedOver[tileFlippedOver.length - 2])) {
                        message.innerHTML = "Match found";
                        cardFlipped = -1;
                        playLockout = false;
                        if (tileFlippedOver.length == tileArray.length) {
                            gameover();
                        }
                    } else {
                        message.innerHTML = "No match";
                        timer = setInterval(hideCard, 1000);
                    }
                } else {
                    cardFlipped = i;
                    cardFlip(i, t);

                }
            } else {
                message.innerHTML = "Locked Out";
            }
        }

        function gameover() {
            message.innerHTML = "Game Over";
            startBtn.style.display = 'block';
            gamePlay = false;
            tileImages = [];
            tileFlippedOver = [];
            gameBoard.innerHTML = '';
        }

        function isinArray(v, array) {
            return array.indexOf(v) > -1;
        }

        function hideCard() {
            for (let x = 0; x < 2; x++) {
                let vid = tileFlippedOver.pop();
                document.getElementById(vid).src = 'http://via.placeholder.com/250/000000/ffffff?text=click';
            }
            clearInterval(timer);
            cardFlipped = -1;
            playLockout = false;
            message.innerHTML = "Select Again";
        }

        function checkSrc(a) {
            return document.getElementById(a).src;
        }

        function cardFlip(i, t) {
            t.src = "http://via.placeholder.com/250/ffffff/000000?text=" + tileArray[i];
            tileFlippedOver.push(t.id);
        }

        function buildArray() {
            for (let x = 1; x < 7; x++) {
                tileImages.push(x + '.jpg');
            }
        }

        function shuffleArray(array) {
            for (let x = array.length - 1; x > 0; x--) {
                let holder = Math.floor(Math.random() * (x + 1));
                let itemValue = array[x];
                array[x] = array[holder];
                array[holder] = itemValue;
            }
            return array;
        }

    </script>
</body>

</html>